---
storage_pools:
- name: {{ "lxd-storagepool-name" | lookup }}
  driver: zfs
  config:
    size: {{ "lxd-volume-size" | lookup }}GB

networks:
- name: lxd0
  type: bridge
  config:
    ipv4.address: {{ "lxd-network-cidr" | lookup }}
    ipv4.nat: true
    ipv6.address: none
    dns.mode: dynamic

profiles:
- name: default
  devices:
    root:
      type: disk
      path: /
      pool: default
    eth0:
      type: nic
      nictype: bridged
      parent: lxd0
  config:
    user.user-data: |
      #cloud-config
      ssh_authorized_keys:
      - {{ "cat /home/ubuntu/.ssh/id_rsa.pub" | sh }}
